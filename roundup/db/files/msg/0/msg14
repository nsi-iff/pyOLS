Almost done as of r108.  Just need to write the test of cascading deletes.